import pickle
from malware_gym.envs.feature_extractor import pefeature
import numpy as np


def read_file(path):
    try:
        with open(path, "rb") as f:
            temp = f.read()
    except:
        raise "Unable to read file from {}".format(path)

    return temp


def predict(sample):
    extractor = pefeature.PEFeatureExtractor2()
    features = np.asarray(extractor.extract(sample))
    features = features.reshape(1, -1)
    blackbox = pickle.load(open("../models/blackbox.pkl", "rb"))
    return blackbox.predict(features)[0]
